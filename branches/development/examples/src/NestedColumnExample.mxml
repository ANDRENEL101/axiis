<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:axiis="http://www.axiis.org/2009"
	xmlns:degrafa="http://www.degrafa.com/2007" backgroundGradientColors="[0xFFFFFF,0xDDDDDD]"
	layout="absolute"
	initialize="start()" xmlns:geometry="org.axiis.charts.geometry.*" xmlns:states="org.axiis.states.*"
	xmlns:Examples="Examples.*">

	<mx:Script>
		<![CDATA[
			import mx.charts.chartClasses.ChartBase;
			import org.axiis.data.DataSet;
			
			private var ds:DataSet = new DataSet();
			
			private function start():void
			{
				ds.processXmlString(xml);
				clusterLayout.dataProvider = ds.data.object.nodes.node;
			}
			
			public function colorFunction3(val:Object):Number {
				return Number(val) | 0x0000ff;
			}
			
			public function colorFunction2(val:Object):Number {
				return 0x00ff00;
			}
			
			public function colorFunction1(val:Object):Number {
				return Number(val) | 0x0099ff;
			}
			
		]]>
	</mx:Script>
	
	<mx:XML id="xml" source="/data/hierarchicalData.xml"/>
	
	<Examples:ExampleBackground width="100%" height="100%" title="Nested Columns" subTitle="Custom Visualization"/>

	<axiis:LinearScale id="scale" maxLayout="{dataCanvas.height}" minLayout="0" minValue="0" maxValue="100"/> 

	<axiis:DataCanvas id="dataCanvas"  left="80" right="80" top="130" bottom="130">
		<axiis:layouts>
			<axiis:HBoxLayout id="clusterLayout" name="A" width="{dataCanvas.width}" height="{dataCanvas.height}" x="0" y="0" scaleFill="true" dataField="value" percentGap=".05">
				<axiis:drawingGeometries>
					<degrafa:RegularRectangle
						stroke="{blackStroke}" fill="{fill1}" 
						height="{scale.valueToLayout(clusterLayout.currentValue)}" x="{clusterLayout.currentReference.x}" y="{clusterLayout.height-scale.valueToLayout(clusterLayout.currentValue)}"
						width="{clusterLayout.currentReference.width}"/>
				</axiis:drawingGeometries> 
				<axiis:layouts>
					<axiis:HBoxLayout id="columnLayout" width="{clusterLayout.currentReference.width}" height="{clusterLayout.currentReference.height}"  dataProvider="{clusterLayout.currentDatum.node}" percentGap="0" x="0" y="5" name=" B" dataField="value">
						<axiis:drawingGeometries>
							<degrafa:RegularRectangle
								stroke="{blackStroke}" fill="{fill2}" id="column"
								height="{scale.valueToLayout(columnLayout.currentValue)}" x="{columnLayout.currentReference.x}" y="{clusterLayout.height-scale.valueToLayout(columnLayout.currentValue)}"
								width="{columnLayout.currentReference.width}"/>
						</axiis:drawingGeometries> 
						<axiis:layouts>
							<axiis:HBoxLayout id="subColumnLayout" width="{columnLayout.currentReference.width}" height="{columnLayout.currentReference.height}" dataProvider="{columnLayout.currentDatum.node}" y="0" x="0" percentGap="0" name="  C" dataField="value">
								<axiis:drawingGeometries>
									<degrafa:RegularRectangle
										id="subColumn" stroke="{blackStroke}" fill="{fill3}" x="{subColumnLayout.currentReference.x}"
										height="{scale.valueToLayout(subColumnLayout.currentValue)}" y="{clusterLayout.height-scale.valueToLayout(subColumnLayout.currentValue)}"
 										width="{subColumnLayout.currentReference.width}"/>
								</axiis:drawingGeometries>
								
								<axiis:states>
									<axiis:State enterStateEvent="mouseOver"
										exitStateEvent="mouseOut"
										properties="{['color']}"
										values="{[colorFunction3]}"
										targets="{[stop3]}"/> 
								</axiis:states>
								
							</axiis:HBoxLayout>
						</axiis:layouts>
						
						<axiis:states>
							<axiis:State enterStateEvent="mouseOver"
								exitStateEvent="mouseOut"
								properties="{['color']}"
								values="{[colorFunction2]}"
								targets="{[stop2]}"
								propagateToDescendents="true"/>
						</axiis:states>
						
					</axiis:HBoxLayout>
				</axiis:layouts>
				
				<axiis:states>
					<axiis:State enterStateEvent="mouseOver"
						exitStateEvent="mouseOut"
						properties="{['color']}"
						values="{[colorFunction1]}"
						targets="{[stop1]}"
						propagateToDescendents="true"/>
				</axiis:states>
				
			</axiis:HBoxLayout>
		</axiis:layouts>
		
		<axiis:strokes>
			<degrafa:SolidStroke id="blackStroke" color="0"/>
		</axiis:strokes>
		
		<axiis:fills>
			<degrafa:LinearGradientFill id="fill1" angle="295">
				<degrafa:GradientStop color="0x4477FF" />
				<degrafa:GradientStop color="0x333388" id="stop1"/>
			</degrafa:LinearGradientFill>
			<degrafa:LinearGradientFill id="fill2" angle="1">
				<degrafa:GradientStop color="0xFFFF44" alpha=".9" id="stop2"/>
				<degrafa:GradientStop color="0x888833"  />
			</degrafa:LinearGradientFill>
			<degrafa:LinearGradientFill id="fill3" angle="1">
				<degrafa:GradientStop color="0xFF4444" alpha=".9"   id="stop3"/>
				<degrafa:GradientStop color="0x883333"/>
			</degrafa:LinearGradientFill>
		</axiis:fills>
		
	</axiis:DataCanvas>
	
</mx:Application>
